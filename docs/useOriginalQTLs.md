# Trying CaMMEL with hQTLs called by the Blueprint Consortium

I wanted to start by trying CaMMEL with the hQTLs that have already been called ['link'](ftp://ftp.ebi.ac.uk/pub/databases/blueprint/blueprint_Epivar/qtl_as/).

## Pre-processing

First, I processed their QTL data to make the format compatible with CaMMEL.

Fields provided: 'chr:pos_ref_alt, rsid, phenotypeID, p.value, beta, Bonferroni.p.value, FDR, alt_allele_frequency, std.error_of_beta'

Fields required: 'chr, rs, snp.loc, med.id, qtl.a1, qtl.a2, qtl.beta, qtl.z'

The correspondence between fields is mostly self-explanatory. A few things deserve mention: 

* 'med.id <- phenotypeID' This is presumably the histone mark peak location being tested for association.
* 'qtl.z <- qnorm(qtl$p.value/2,lower.tail=FALSE)*sign(qtl$beta)'

Next, I split the QTLs by LD block, according to the European LD blocks generated by Berisa and Pickrell (['paper'](https://academic.oup.com/bioinformatics/article/32/2/283/1743626), ['data'](https://bitbucket.org/nygcresearch/ldetect-data)).


 

